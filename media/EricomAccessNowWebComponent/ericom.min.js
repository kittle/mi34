var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(a){if(typeof a=="string")a=document.getElementById(a);if(!a.addClass){a.hide=function(){this.style.display="none"};a.show=function(){this.style.display=""};a.addClass=function(c){this.removeClass(c);this.className+=" "+c};a.removeClass=function(c){for(var h=this.className.split(/\s+/),n=-1,p=0;p<h.length;p++)if(h[p]==c){n=p;p=h.length}if(n>-1){h.splice(n,1);this.className=h.join(" ")}return this};a.hasClass=
function(c){return!!this.className.match(RegExp("\\s*"+c+"\\s*"))}}return a},setMoviePath:function(a){this.moviePath=a},dispatch:function(a,c,h){(a=this.clients[a])&&a.receiveEvent(c,h)},register:function(a,c){this.clients[a]=c},getDOMObjectPosition:function(a,c){for(var h={left:0,top:0,width:a.width?a.width:a.offsetWidth,height:a.height?a.height:a.offsetHeight};a&&a!=c;){h.left+=a.offsetLeft;h.top+=a.offsetTop;a=a.offsetParent}return h},Client:function(a){this.handlers={};this.id=ZeroClipboard.nextId++;
this.movieId="ZeroClipboardMovie_"+this.id;ZeroClipboard.register(this.id,this);a&&this.glue(a)}};
ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:"",handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(a,c,h){this.domElement=ZeroClipboard.$(a);a=99;if(this.domElement.style.zIndex)a=parseInt(this.domElement.style.zIndex,10)+1;if(typeof c=="string")c=ZeroClipboard.$(c);else if(typeof c=="undefined")c=document.getElementsByTagName("body")[0];var n=ZeroClipboard.getDOMObjectPosition(this.domElement,c);this.div=document.createElement("div");var p=this.div.style;p.position=
"absolute";p.left=""+n.left+"px";p.top=""+n.top+"px";p.width=""+n.width+"px";p.height=""+n.height+"px";p.zIndex=a;if(typeof h=="object")for(addedStyle in h)p[addedStyle]=h[addedStyle];c.appendChild(this.div);this.div.innerHTML=this.getHTML(n.width,n.height)},getHTML:function(a,c){var h="",n="id="+this.id+"&width="+a+"&height="+c;if(navigator.userAgent.match(/MSIE/)){var p=location.href.match(/^https/i)?"https://":"http://";h+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+
p+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+a+'" height="'+c+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+n+'"/><param name="wmode" value="transparent"/></object>'}else h+=
'<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+a+'" height="'+c+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+n+'" wmode="transparent" />';return h},hide:function(){if(this.div)this.div.style.left="-2000px"},show:function(){this.reposition()},destroy:function(){if(this.domElement&&
this.div){this.hide();this.div.innerHTML="";var a=document.getElementsByTagName("body")[0];try{a.removeChild(this.div)}catch(c){}this.div=this.domElement=null}},reposition:function(a){if(a)(this.domElement=ZeroClipboard.$(a))||this.hide();if(this.domElement&&this.div){a=ZeroClipboard.getDOMObjectPosition(this.domElement,this.div.offsetParent);var c=this.div.style;c.left=""+a.left+"px";c.top=""+a.top+"px"}},setText:function(a){this.clipText=a;this.ready&&this.movie.setText(a)},addEventListener:function(a,
c){a=a.toString().toLowerCase().replace(/^on/,"");this.handlers[a]||(this.handlers[a]=[]);this.handlers[a].push(c)},setHandCursor:function(a){this.handCursorEnabled=a;this.ready&&this.movie.setHandCursor(a)},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(a,c){a=a.toString().toLowerCase().replace(/^on/,"");switch(a){case "load":this.movie=document.getElementById(this.movieId);if(!this.movie){var h=this;setTimeout(function(){h.receiveEvent("load",null)},1);return}if(!this.ready&&
navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){h=this;setTimeout(function(){h.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.setText(this.clipText);this.movie.setHandCursor(this.handCursorEnabled);break;case "mouseover":if(this.domElement&&this.cssEffects){this.domElement.addClass("hover");this.recoverActive&&this.domElement.addClass("active")}break;case "mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");
this.recoverActive=true}this.domElement.removeClass("hover")}break;case "mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case "mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}}if(this.handlers[a])for(var n=0,p=this.handlers[a].length;n<p;n++){var f=this.handlers[a][n];if(typeof f=="function")f(this,c);else if(typeof f=="object"&&f.length==2)f[0][f[1]](this,c);else if(typeof f=="string")window[f](this,
c)}}};var LOG_NAME="AccessNowLog.txt",LOG_QUOTA=10485760;function noop(){}function retArg(a){return a}window.reqFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;window.logToFile=noop;if(!Function.prototype.bind)Function.prototype.bind=function(a){var c=[].slice,h=c.call(arguments,1),n=this;return function(){return n.apply(a,h.concat(c.call(arguments)))}};function consoleLog(a){var c=slice(arguments,1);a.apply?a.apply(console,c):a(c.join(" "));logToFile.apply(window,c)}
try{var CL=consoleLog.bind(this,console.log),CI=consoleLog.bind(this,console.info),CE=consoleLog.bind(this,console.error)}catch(e$$6){CE=CI=CL=noop}
function startLogging(a){function c(){var g=new Date,j=g.toString();return j.substring(0,j.indexOf("GMT")-1)+":"+("00"+g.getMilliseconds()).slice(-3)}function h(g){g&&console.info("File system quota:",g);reqFileSystem(PERSISTENT,LOG_QUOTA,function(j){function i(){j.root.getFile(a||LOG_NAME,{create:true},function(o){o.createWriter(function(m){m.onwriteend=f=function(){if(p.length>0&&m.readyState!==m.WRITING){var w=new WebKitBlobBuilder;w.append(p);m.write(w.getBlob("text/plain"));p=""}};m.onerror=
function(w){n((w.target||w.srcElement).error)};window.isLogging=true;"toURL"in o&&alert(o.toURL());p.length>1&&f()},n)},n)}j.root.getFile(LOG_NAME,{create:false},function(o){o.remove(i,i)},i)},n)}function n(g){switch(g.code){case g.QUOTA_EXCEEDED_ERR:g="QUOTA_EXCEEDED_ERR";break;case g.NOT_FOUND_ERR:g="NOT_FOUND_ERR";break;case g.SECURITY_ERR:g="SECURITY_ERR";break;case g.INVALID_MODIFICATION_ERR:g="INVALID_MODIFICATION_ERR";break;case g.INVALID_STATE_ERR:g="INVALID_STATE_ERR";break;default:g="Unknown Error"}console.error("File System Error: ",
g);window.isLogging=false;window.logToFile=noop;p=""}if(window.reqFileSystem!==undefined){var p=function(){var g=c()+": Location: "+location+"\n";g+=function(j){var i="";if(j){i=c()+": "+j+"\n";for(var o in j){var m=j[o],w=typeof m;if(w==="string"||w==="number")i+=o+": "+m+"\n"}}return i}(navigator);return g}(),f=window.logToFile;window.logToFile=function(){p+=c()+": "+slice(arguments).join(" ")+"\n";f.apply(window,arguments)};try{webkitStorageInfo.requestQuota(PERSISTENT,LOG_QUOTA,h,n)}catch(u){h()}}}
;var slice=[].slice;slice=slice.call.bind(slice);function isString(a,c){return typeof a==="string"&&a.length>=(c||1)}function isTrue(a){return isString(a)?a.search(/^\s*(true|yes|on|1)\s*$/i)>=0:!!a}String.prototype.toArray=function(){return this.trim().split(/\s*[ ,;]+\s*/)};function newImage(){return document.createElement("img")}
var cookies=function(){return{all:function(a){a=a||{};var c=a.raw?retArg:decodeURIComponent,h=a.filter||retArg;return document.cookie.split(";").reduce(function(n,p){p=p.match(/^ *([^ =]+) *= *(.*)$/);if(p!==null){var f=h(decodeURIComponent(p[1]));if(f)n[f]=c(p[2])}return n},{})},get:function(a,c){var h=document.cookie.match(RegExp("(?:^|;) *"+encodeURIComponent(a)+" *= *([^;]*)"));return h===null?null:(c?retArg:decodeURIComponent)(h[1])},create:function(a,c,h){h=typeof h==="number"?{expires:h}:h||
{};a=h.orig?a:encodeURIComponent(a);a=[a+"="+(h.raw?retArg:encodeURIComponent)(c)];if("expires"in h){c=h.expires;if(!(c instanceof Date)){c=new Date;c.setDate(c.getDate()+h.expires)}a.push("expires="+c.toGMTString())}a.push("path="+("path"in h?path:"/"));document.cookie=a.join("; ")},remove:function(a){switch(typeof a){case "string":case "number":this.create(a,"",{expires:-1});this.create(encodeURIComponent(a).replace(/_/g,"%5F"),"",{expires:-1,orig:true});break;case "undefined":a=retArg;case "function":var c=
this.all({filter:function(n){return a(n)?n:null}}),h;for(h in c)this.remove(h)}}}}();function isCanvasSupported(){var a=document.createElement("canvas");return!!(a.getContext&&a.getContext("2d"))}window.WebSocket=window.WebSocket||window.MozWebSocket;if(!WebSocket&&(defaults.noHTTPS||!cookies.get("ESG_GWID"))||!isCanvasSupported())location.replace("notsupported.html"+(window.appName?"?"+window.appName:""));window.myURL=window.URL||window.webkitURL;
window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;var canUseBlobs=window.myURL&&window.BlobBuilder&&location.protocol!=="file:";function decode(a){if(isString(a)){var c=a.indexOf("base64,",6);if(!(c<0)){a=atob(a.substring(c+7));c=a.length;for(var h=new Uint8Array(c),n=0;n<c;++n)h[n]=a.charCodeAt(n);return h.buffer}}}
var blobURL=canUseBlobs?function(a,c){var h=decode(a),n=new BlobBuilder;n.append(h);h=a.indexOf(c||"image",5);c=a.substring(h,a.indexOf(";",h+7));n=n.getBlob(c);return window.myURL.createObjectURL(n)}:retArg;function assign(a,c){var h=a.getAttributeNode("src"),n=!h;if(n)h=document.createAttribute("src");h.nodeValue=blobURL(c);n&&a.setAttributeNode(h)}
var revoke=canUseBlobs?function(a){a=a.getAttributeNode("src");window.myURL.revokeObjectURL(a.nodeValue)}:noop,is={browserType:function(a){return navigator.userAgent.match(a)!==null}};is.HTTPS=location.protocol.search(/https/g)===0;is.apple=is.browserType(/(iPad)|(iPhone)|(iPod)/);is.mobile=is.apple||is.browserType(/(Mobi)|(Tablet)|(hpwOS)|(Android)/);is.webkit=is.browserType(/WebKit/i);is.chrome=is.browserType(/Chrome.(\S+)/);is.chromeOS=is.browserType(/CrOS/);is.IE=is.browserType(/MSIE (\S+)/);
is.firefox=is.browserType(/Firefox.(\S+)/);is.safari=is.browserType(/Version.(\S+)\sSafari/);var hasLocalStorage=function(){var a=false;if(window.localStorage)try{sessionStorage.setItem("k","v");a=sessionStorage.getItem("k")=="v";sessionStorage.removeItem("k")}catch(c){CI("Private browsing")}return a}(),localS,sessionsS;
(function(){if(hasLocalStorage){localS=localStorage;sessionsS=sessionStorage}else{var a=function(){},c=a.prototype;c.getItem=function(h){return h in this?this[h]:null};c.setItem=function(h,n){this[h]=n};c.removeItem=function(h){delete this[h]};c.clear=function(){for(var h in this)this.removeItem(h)};localS=new a;sessionsS=new a}})();var genGUID="".replace.bind("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",/[xy]/g,function(a){var c=Math.random()*16|0;return(a==="x"?c:c&3|8).toString(16)});
isString(localS.getItem("GUID"))||localS.setItem("GUID",genGUID());window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||window.setImmediate;
var scheduleAnimFrame=function(){function a(n){var p=Date.now();logToFile(n);n=h;h=[];for(var f=0;f<n.length;++f)if(n[f](p)){h=n.slice(f).concat(h);break}logToFile("done")}var c,h=[];setInterval(function(){document.hidden!==false&&a("update")},(defaults.hiddenUpdateRateSeconds||20)*1E3);return function(n){h.push(n);if(c===undefined)c=window.requestAnimFrame(function(){c=undefined;a("frame")});return c}}();function usernameContainsDomain(a){return a.match(/[\\@]/)!==null}
$(function(){window.origWidth=innerWidth;window.origHeight=innerHeight});function screenSize(a){switch(a){case "screen":if(!is.mobile)return[screen.width,screen.height];case "browser":return Math.max(screen.width,screen.height)>800?[origWidth,origHeight]:[800,600];default:return eval("["+a+"]")}}function supportsMIME(a){for(var c=navigator.mimeTypes,h=0;h<c.length;++h)for(var n=c[h].suffixes.split(","),p=0;p<n.length;++p)if(n[p]===a)return true;return false}
function copyObject(){return jQuery.extend.apply(jQuery,[{}].concat(slice(arguments)))}function cancelEvent(a){a.stopPropagation();a.preventDefault();return false}
(function(a){a.fn.extend({if_:function(c){if(jQuery.isFunction(c))c=c.call(this);this.if_CondMet=!!c;return this.pushStack(c?this:[])},else_:function(c){var h=this.end();return h.if_CondMet?h.pushStack([]):h.if_(arguments.length?c:1)},enable:function(){return this.if_(function(){return this.val()}).select().else_().focus().end()},resetForm:function(){return this.filter("form").each(function(){this.reset()})},dataset:function(c){switch(this.length){case 0:return null;case 1:return this[0].dataset?
this[0].dataset[c]:this.attr("data-"+c);default:var h={};this.each(function(n){h[a(n).attr("id")]=a(n).dataset(c)});return h}},reveal:function(){setImmediate(this.addClass.bind(this,"show"));return this.css("display","inline-block")},obscure:function(){return this.hide().removeClass("show")},getValues:function(c,h,n){h=h||{};n=a.isFunction(n)?n:retArg;a(this).find(":input").not(":button").each(function(){var p=a(this),f=p.attr(c);if(f&&(f=n(f)))h[f]=!p.is(":input")?p.html():!p.is(":checkbox")?p.val():
p.is(":checked")?1:0});return h},setValues:function(c,h){if(c){h=a.isFunction(h)?h:retArg;this.find("*[id]:not(:disabled)").each(function(){var n=a(this),p=h(n.attr("id"));if(p){p=c[p];if(p!==undefined)if(n.is(":checkbox"))n.attr("checked",isTrue(p));else n.is(":input")?n.val(p):n.html(p)}})}return this},enableDisable:function(c){function h(){var p=a(this),f=p.dataset("for");isString(f)&&p.parents("form:eq(0)").find(f).attr("disabled",!p.is(":checked"))}var n=this.find(":checkbox").each(h);c!==false&&
n.click(function(){setImmediate(h.bind(this))});return this},hidden:function(c){(c=isString(c)?c.toArray():c)&&c.forEach&&c.forEach(function(h){this.find("#"+h).if_(function(){return this.is(":button")}).css("visibility","hidden").else_(function(){return this.is("form")}).hide().else_().parents("tr").hide()},this);return this},preventSelection:function(){return this.on("selectstart",false).attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-o-user-select":"none",
"user-select":"none"})},enterFullScreen:function(){return this.each(function(){var c=this.requestFullScreen||this.webkitRequestFullScreen||this.mozRequestFullScreen;c&&c.call(this,this.ALLOW_KEYBOARD_INPUT);return false})},leaveFullScreen:function(){var c=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;c&&c.call(document);return this}})})(jQuery);
var urlParams=location.search.split("&").reduce(function(a,c){c=c.match(/^\??([^=]+)=?(.*)/);if(c!==null)a[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);return a},{}),externals=function(a){function c(n){if(n.substring(0,4)==="EAN_")return n.substring(4)}var h=cookies.all({filter:c});cookies.remove(c);return a.extend(h,urlParams)}(jQuery),calcGlobals=function(a){externals.settings&&a.extend(defaults,defaults[externals.settings]);var c=(externals.hidden||defaults.hidden||"").toArray();if(c.length===
1&&c[0]==="")c=[];for(a=0;a<c.length;++a)localStorage.removeItem(c[a]);c.indexOf("remember")!==-1&&localStorage.removeItem("password");var h=defaults.overrideSaved||externals.overrideSaved;return function(){return copyObject(h?localStorage:defaults,h?defaults:localStorage,externals,{hiddenFields:c})}}(jQuery),globals=calcGlobals(externals);globals.isManaged=isTrue(globals.isManaged)||!!externals.id;globals.isView=window.appName==="view";globals.autostart=isTrue(globals.autostart);
globals.rightToLeft=isTrue(globals.rightToLeft);globals.clipboardUseFlash=isTrue(globals.clipboardUseFlash);globals.console=isTrue(globals.console);if(globals.log){startLogging();(function(){for(var a in globals)logToFile("setting",a,"=",globals[a])})()}function clientType(){return externals.id?2:globals.isView?1:globals.isManaged?3:0}
function clientID(){switch(clientType()){case 2:return"AccessNow for PowerTerm WebConnect";case 1:return"AccessNow for VMware View";case 3:return"AccessManager";default:return"AccessNow"}}if(is.mobile){document.title="AccessNow";innerWidth<=600&&$(window).load(setImmediate.bind(window,scroll.bind(window,100,192)))};var dialog=function(a){var c=(globals.dialogTimeoutMinutes||2)*6E4,h=[newImage(),newImage()];h[0].src="resources/info.png";h[1].src="resources/error.png";var n=newImage();n.src=globals.connectingImage||"resources/connecting.gif";var p=newImage();p.src="resources/poweredby-ericom.gif";return{modal:function(f,u){function g(m){m.stopPropagation()}f=a(f);u=copyObject(u);var j,i=u.context||u;if(u.reset){var o=f.data("modal");o&&o.destroy()}f.data("modal")||f.data("modal",{dialog:function(){return f},open:function(m){if(m)u.onClose=
m;j=true;return!f.dialog("isOpen")&&f.dialog("open").dialog("isOpen")},isOpen:function(){return f.dialog("isOpen")},title:function(m){var w=f.find("p");w.length?w.html(m):f.dialog("option","title",m);logToFile("dialog:",m)},close:function(){j=false;f.dialog("close")},destroy:function(m){f.dialog("isOpen")&&f.data("modal").close();f.dialog("destroy").removeData("modal").if_(m).remove()}});f.dialog(a.extend({modal:true,autoOpen:false,resizable:false,position:["center",innerHeight/4],buttons:{OK:function(){f.dialog("close")}}},
u.options)).off(".modal").on({"dialogopen.modal":function(){f.dialog("widget").on({"keydown.dialog":g,"keyup.dialog":g,"keypress.dialog":g}).find("button:first").focus()},"dialogclose.modal":function(){f.dialog("widget").off(".dialog");a.isFunction(u.onClose)&&u.onClose.call(i,j)!==false&&setTimeout(function(){a(":submit:visible").focus();a("input:visible").first().select()},0);if(u.destroy||u.remove)f.data("modal").destroy(u.remove)}});(o=f.data("modal"))&&u.html&&o.title(u.html);return o},notify:function(f,
u){if(isString(f))f={html:f};var g=f.onClose;f=copyObject(f,{remove:true,onClose:function(){i!==undefined&&clearTimeout(i);if(a.isFunction(g))return g.apply(this,arguments)}});var j=this.modal('<div class="dialog"><img src="'+h[u||f.critical?1:0].src+'" /></div>',f);if(j.open())var i=setTimeout(function(){i=undefined;j.close()},f.timeout||c);return j},restart:function(f){if(isString(f))f={html:f};f=a.extend({options:f.logout?{buttons:{Close:function(){a(this).dialog("close")},"Log off":function(){g=
f.logout;a(this).dialog("close")}}}:{}},f);var u=this,g=f.restart;return function(j,i){if(j)f.html=j;u.notify(f,i).open(function(o){if(!o)g=f.logout;if(!g||g.apply(this,arguments))location.reload(false)})}},progress:function(f,u){if(isString(f))f={html:f,onCancel:u};f=a.extend({remove:true,onClose:function(o){setTimeout(function(){window.focus()},1E3);if(o&&!g&&a.isFunction(f.onCancel))f.onCancel()},options:{width:"auto",buttons:{Cancel:function(){g=true;f.canceling&&i.title(f.canceling);j.dialog("widget").find("button").button("disable");
if(a.isFunction(f.onCancel))f.onCancel()}}}},f);var g,j=a('<div class="dialog"><img src="'+n.src+'" /></div>');globals.connectingImage?j.append('<img src="'+p.src+'" style="position:absolute; bottom:16px; left:'+(n.width-p.width)+'px" /></div>'):j.prepend("<h1>Ericom&reg; AccessNow&trade;</h1>");var i=this.modal(j,f);i.open();return i},modeless:function(f){f=a.extend({remove:true},f);f.options=a.extend({modal:false,autoOpen:true},f.options);return this.modal(f.template?a(f.template).clone():a("<div>"),
f)},progressbar:function(f){function u(i){i=i===undefined?100:Math.round(i);if(i>=0){g.dialog("option","title",f.html+": "+i+"%");j.progressbar("option","value",i)}else{g.dialog("option","title",f.html);j.progressbar("option","value",50)}}f=isString(f)?{html:f}:copyObject(f);f.template=a('<div><div id="progressbar"></div></div>').addClass(f.dialogClass||"dialog");f.options=a.extend({resizable:false,buttons:{Cancel:function(){g.dialog("close");if(a.isFunction(f.onCancel))f.onCancel()},Hide:function(){g.dialog("close")}}},
f.options);var g=this.modeless(f).dialog(),j=g.find("#progressbar").addClass(f.progressbarClass||"progressbar").progressbar({complete:function(){g.dialog("close")}});u(f.value||0);return u}}}(jQuery);function database(a,c,h,n){if(!("openDatabase"in window)){CI("No database support");return p}try{var p=openDatabase(a,h||"1.0",c||a,n||1E5)}catch(f){f===2?CE("Invalid database version"):CE("database open:",f)}return p===undefined?p:function(u,g,j,i){function o(I){switch(typeof I){case "boolean":return{type:"INTEGER",convert:Number};case "number":return I===Math.round(I)?{type:"INTEGER",convert:parseInt}:{type:"REAL",convert:parseFloat};case "string":var x=Number(I);if(x.toString()===I)return o(x);
default:return{type:"TEXT",convert:String}}}function m(){function I(E){A?E(A):p.transaction(E)}function x(E){return function(){typeof E==="function"&&E(B)}}function y(E){var J=[],G=[],C;for(C in E){J.push(C+"=?");G.push(E[C])}J=J.length?" WHERE "+J.join(" AND "):"";return{test:J,values:G}}var A,B={name:function(){return g},handle:function(){return p},transaction:function(E){p.transaction(function(J){try{A=J;E(B)}finally{A=undefined}})},insert:function(E,J,G){var C=[],H;for(H in t)C.push(t[H](E[H]));
I(function(b){b.executeSql("INSERT INTO "+g+z+D,C,x(J),function(e,k){CE("database insert",k.message);typeof G==="function"&&G()})})},read:function(E,J,G,C){E=y(E);I(function(H){H.executeSql("SELECT * FROM "+g+E.test+";",E.values,function(b,e){if(typeof G==="function"){var k=e.rows;if(typeof J==="string")for(var l={},s=0;s<k.length;++s){var v=k.item(s);l[v[J]]=v}else{l=Array(k.length);for(s=0;s<k.length;++s)l[s]=k.item(s)}G(l,B)}},function(b,e){CE("database read",e.message);typeof C==="function"&&
C()})})},remove:function(E,J,G){E=y(E);I(function(C){C.executeSql("DELETE FROM "+g+E.test+";",E.values,x(J),function(H,b){CE("database remove",b.message);typeof G==="function"&&G()})})},drop:function(E,J){I(function(G){G.executeSql("DROP TABLE "+g+";",[],x(E),function(C,H){CE("database drop",H.message);typeof J==="function"&&J()})})}};return B}if(typeof g!=="string")g=a;var w=[],z=[],D=[],t={},F;for(F in u){var L=o(u[F]);w.push(F+" "+L.type);D.push("?");z.push(F);t[F]=function(I){var x=I(u[F]);return function(y){return y!==
undefined&&y!==null?I(y):x}}(L.convert)}w=w.join(",");z="("+z.join(",")+")";D=" VALUES ("+D.join(",")+");";p.transaction(function(I){I.executeSql("CREATE TABLE IF NOT EXISTS "+g+"("+w+");",[],function(){typeof j==="function"&&j(m())},function(x,y){CE("database create",g," ",y.message);typeof i==="function"&&i()})})}};var PROTOCOL="ericom|accessnow.2",GW_PROTOCOL_VERSION=1,HTTPS_SEPARATOR="|`";
function connect(a){function c(){CI("Can't connect using WebSockets");if(!globals.noHTTPS&&a.gateway)h(new WSHTTPS(a.gateway),a);else $.isFunction(a.onclose)&&a.onclose.apply(this,arguments)}function h(g,j){for(var i in j)if(i.substring(0,2)==="on")g[i]=j[i]}function n(g){return copyObject(g,{URL:function(){var j=g.gateway;if(j.indexOf(":")===-1)j+=":"+globals.gwport;return"wss://"+j}(),onopen:function(){var j=g.clientID?u.build(false,3,[null,null,null,g.clientID]):u.build(false,1,[null,g.username,
g.password]);this.send(u.build(true,1,[null,"AccessNow",g.username,j,g.address,g.port,"","","",navigator.userAgent,"unknown","unknown",this.isHTTPS?"ssl":"wss",g.encryption?"wss":"ws",null,null,externals.id?"WebConnect":globals.isView?"VmWareView":"None",null,null,null,null,this.isHTTPS?2:0]),{target:"connect?target="+encodeURIComponent(g.target)+"&protocol="+encodeURIComponent(g.protocol),reply:true});$.isFunction(g.ongwopen)&&g.ongwopen.apply(this,arguments)},onmessage:function(j){try{var i=u.parse(j.data);
if(i.values[7]==="0"){this.setID&&this.setID(i.values[6]);h(this,g);$.isFunction(g.onopen)&&g.onopen.call(this);return}i=i.values[8]}catch(o){i=o}$.isFunction(g.onerror)&&g.onerror.call(this,"Gateway: "+i)},onerror:function(){CE("Gateway error");h(this,g);return g.onerror.apply(this,arguments)}})}a=copyObject(a);a.address=a.address.trim();a.port=parseInt(a.port)||globals.wsport||8080;!globals.singlePort&&!a.encryption&&a.port++;a.target="/blaze"+(a.target?"/"+a.target.trim():"");a.protocol=a.protocol||
PROTOCOL;if(a.gateway){a.gateway=a.gateway.trim();if(a.gateway)a=n(a)}if(!WebSocket||globals.onlyHTTPS)c();else try{var p=new WebSocket((a.URL||(a.encryption?"wss":"ws")+"://"+a.address+":"+a.port)+a.target,a.protocol);p.onopen=function(){h(this,a);$.isFunction(a.onopen)&&a.onopen.apply(this,arguments)};p.onclose=c}catch(f){if($.isFunction(a.onerror))a.onerror(f.code==1E3?"Must connect using SSL encryption":f.message||"Error opening WebSockets");else if($.isFunction(a.onclose))a.onclose()}var u=function(){function g(j){j=
j.toString();var i=unescape(encodeURIComponent(j)).length.toString();return i.length+i+j}return{build:function(j,i,o){var m=[];m.push(g(GW_PROTOCOL_VERSION));m.push(g(i));o.forEach(function(w,z){if(w!==undefined&&w!==null){m.push(g(z));m.push(g(w))}});m=m.join("");return j?"BgwS"+m:m},parse:function(j){for(var i=[],o=0;o<j.length;){var m;m=j;var w=parseInt(m.charAt(o++)),z=o+w;w=parseInt(m.substring(o,z));o=z;z+=w;m={value:m.substring(o,z),index:z};i.push(m.value);o=m.index}j=[];for(o=2;o<i.length;){m=
parseInt(i[o++]);if(isNaN(m))throw"bad id "+i[o-1];w=i[o++];if(w===undefined)throw"missing value "+m;j[m]=w}o=parseInt(i[0]);if(isNaN(o))throw"bad message protocol "+i[0];m=parseInt(i[1]);if(isNaN(m))throw"bad message id "+i[1];return{protocol:o,id:m,values:j}}}}();return a}
function WSHTTPS(a){function c(j,i,o,m){CE("HTTPS error",j,o,m);if(o!=="abort"&&$.isFunction(this.onerror)){m||(m="Failed to connect using HTTPS");if(m.toLowerCase()!=="bad request"){if(o!=="error")m="("+o+") "+m;else if(i)m="HTTP "+i+": "+m;this.onerror(m)}}this.close()}CI("Using HTTPS");this.isHTTPS=true;this.URL="ericomsecuregateway/https/";if(a&&(a!=location.host||!is.HTTPS))this.URL="https://"+a+"/"+this.URL;this.CONNECTING=0;this.OPEN=1;this.CLOSING=2;this.CLOSED=3;this.readyState=this.CONNECTING;
this.onmessage=this.onclose=this.onerror=this.onopen=null;var h=this;setImmediate(function(){h.readyState=h.OPEN;if($.isFunction(h.onopen))h.onopen()});var n,p;this.close=function(){CI("Closing HTTPS");if(n){n.abort();n=null}if(p){p.abort();p=null}if(this.readyState!==this.CLOSED){this.readyState=this.CLOSED;if($.isFunction(this.onclose))this.onclose()}};var f;this.setID=function(j){f=encodeURIComponent(j)};var u=function(j){return function(i){if(i){j.data=i.trim();h.onmessage(j);j.data=null}}}({});
this.send=function(j,i,o,m){return function(w,z){function D(){sent=Date.now();n=$.ajax(m);logToFile("HTTPS sent");m=null}z=z||i;if(m){m.data+=w;m.reply=m.reply||z.reply}else{var t=z.target;if(!t){t="up?seq="+j++;if(f)t+="&id="+f}var F=m={url:this.URL+t,type:"post",cache:false,data:w,reply:z.reply,context:this,success:function(L){logToFile("HTTPS response",Date.now()-sent,this.readyState);if(this.readyState===this.OPEN){F.reply&&$.isFunction(this.onmessage)&&u(L);if(m)D();else n=null;if(o&&f){CI("Starting HTTPS polling");
o=g()}}},error:function(L,I,x){logToFile("HTTPS error",x);c.call(this,"up",L.status,I,x)}};n||D()}}}(0,{},true);var g=function(j){return function(){var i=h.URL+"down"+(f?"?id="+f:"");logToFile("HTTPS poll");p=$.ajax({url:i,cache:false,success:function(o){logToFile("HTTPS poll response");if(h.readyState===h.OPEN){g();setImmediate(function(){if(h.readyState===h.OPEN){var m=o.split(HTTPS_SEPARATOR);m[0]=j+m[0];j=m.pop();$.isFunction(h.onmessage)&&m.forEach(u)}})}},error:function(o,m,w){logToFile("HTTPS poll error",
w);c.call(h,"down",o.status,m,w)}})}}("")};function Protocol(){function a(){CI("Gateway opened");j=this;$(w).triggerHandler("gateway")}function c(){CI("Communication opened");j=this;w.isHTTPS=this.isHTTPS;w.hookUp("protocol",{Hello:function(y,A,B,E,J){var G=Date.now()-x;CI("Connected: "+y,A,B,E,J);CI("Round trip: "+G);w.lock(false);$(w).triggerHandler("open",slice(arguments))},Close:function(y){CI("Session closed by AccessNow server"+(y?": "+y:""));w.close()},Keepalive:noop});var x=Date.now();w.send("p","h",[clientID(),1,2,0,0,navigator.userAgent],
true);if(D===undefined&&globals.keepAliveRateSeconds>0)D=setInterval(w.fastSend.bind(w,"p","k",null,true),globals.keepAliveRateSeconds*1E3);$(w).triggerHandler("connect")}function h(x){if(D!==undefined){clearInterval(D);D=undefined}if(x)z=x.reason||z;if(z!==null){CI("Communication closed");j=this;$(w).triggerHandler("close",[z]);z=null}}function n(x){CE("Communication error",x);i=true;$(w).triggerHandler("error",[x])}function p(x,y,A){this.instructions=x;this.marker=y;this.ready=A}function f(x){if(!m){x=
x.data;logToFile("<<<",x);if(x.charCodeAt(0)!==33)t.push(g(x,u));else{logToFile("immediate");x=g(x.substring(1));logToFile("execute");x.instructions.forEach(I);logToFile("done")}}}function u(){for(var x=0;x<t.length&&t[x].ready;++x);if(x){var y=t.splice(0,x);scheduleAnimFrame(function(A){for(var B=0;B<y.length;++B){if(Date.now()-A>L){y.splice(0,B);return true}logToFile("execute",y[B].marker);y[B].instructions.forEach(I)}})}}function g(x,y){function A(b,e){if(!isString(e,64)||e.substring(0,11)!=="data:image/")return e;
++G;var k=ImageCache.alloc();k.onload=E;k.onerror=J;assign(k,e);return k}function B(){logToFile("ready",C.marker);C.ready=true;y()}function E(){this.onerror=this.onload=null;revoke(this);if(--G===0){H!==undefined&&clearTimeout(H);B()}}function J(){CE("Image error",this.src);this.onload()}logToFile("parse",++F);var G=1,C=new p(JSON.parse(x,y?A:null),F,--G===0);if(y)if(C.ready)setImmediate(y);else if(is.IE)var H=setTimeout(function(){CE("panic",C.marker,G);G=0;B()},L+Math.min(G*100,L*4));logToFile("images",
F,G);return C}var j,i=false,o,m,w=this;this.start=function(x){m=false;o=!!x.gateway;this.address=function(){if(j){var y=j.URL||j.url;if(y)if(y=y.match(/:[/]+([^/]+)/))return y.length?y[1]:y}return x.gateway||x.address+(x.port?":"+x.port:"")};this.options=function(){return x};x=connect(copyObject(x,{ongwopen:a,onopen:c,onerror:n,onmessage:f,onclose:h}))};this.isOpen=function(){return j&&j.readyState===j.OPEN};this.isError=function(){return i};this.isGateway=function(){return o};this.hookUp=function(x,
y,A){A=A||{};y=dispatcher(y,isString(A)?A:A.definstruction);this.addChannel(x,y,A.isDefault);this.addChannel(A.shortName||x.charAt(0).toUpperCase(),y)};this.fastSend=function(x,y,A){function B(){if(A===undefined)A=setImmediate(function(){if(y&&w.isOpen()&&x<=0){$(w).triggerHandler("send");if(y){j.send(y);y=""}}A=undefined})}w.lock=function(E){x+=E?1:-1;B()};return function(E,J,G,C){var H=E+";"+J;if(G instanceof Array)H+=";"+G.join(";");if((E!=="u"||J!=="m")&&(E!=="c"||J!=="s"))logToFile(">>>",H);
H+="\n";if(C){if(x<=0){H+=y;y=""}j.send(H)}else{y+=H;B()}}}(1,"");this.send=function(){function x(y){return y.replace(/\\|;|\n/g,function(A){return A==="\\"?"\\\\":A===";"?"\\;":A==="\n"?"\\n":A})}return function(y,A,B,E){if(B)for(var J=Array(B.length),G=0;G<B.length;++G)switch(typeof B[G]){case "string":J[G]=x(B[G]);break;case "boolean":J[G]=B[G]?1:0;break;default:J[G]=B[G]}this.fastSend(y,A,J,E)}}();var z;this.close=function(x){CI("Closing communication:",x);m=true;this.lock(true);z=x;if(j&&(j.readyState===
j.CONNECTING||j.readyState===j.OPEN)){setTimeout(function(){try{j.onclose()}catch(y){}},2E3);j.close()}};var D,t=[],F=0,L=globals.executeTimeout||1E3,I=function(){var x={},y;w.addChannel=function(B,E,J){x[B]=E;if(J)y=B};w.removeChannel=function(B){delete x[B];if(B===y)y=undefined};var A=globals.oldStyleProtocol;return function(B){var E=B.C||B.channel||y;if(A)y=E;var J=x[E];if(J)return J(B);CE("Invalid channel:",E)}}()}
var ImageCache=function(){var a=[];return is.chrome?{alloc:function(){return a.pop()||newImage()},free:function(c){c&&a.push(c)}}:{alloc:newImage,free:noop}}();
function dispatcher(a,c){(function(n){for(var p in n){var f=p.charCodeAt(0);if(65<=f&&f<=90){f=p.replace(/[^A-Z]/g,"");if(f in n)CI("taken",p);else n[f]=n[p]}}})(a);var h=globals.oldStyleProtocol;return function(n){var p=n.I||n.instruction||c;if(h)defchannel=p;var f=a[p];if(f)return f.apply(a,n.A||n.arguments);CE("Invalid instruction:",p)}};function Raster(a,c){function h(b){if(typeof b!=="number")return b;b=(b&16777215).toString(16);return"#000000".substring(0,7-b.length)+b}function n(b){switch(typeof b){case "number":return[(b&16711680)>>16,(b&65280)>>8,b&255];case "string":return[parseInt(b.substring(1,3),16),parseInt(b.substring(3,5),16),parseInt(b.substring(5,7),16)];default:return b}}function p(b){if(b){var e=z.createPattern(b,"repeat");e.width=b.width;e.height=b.height;ImageCache.free(b);return e}}function f(b,e,k,l,s,v){e=J(e,
k,l,s);if(e[2]&&e[3])if(v=v.apply(this,e)){if(!$.isFunction(b))if(k=E[b])b=k;else{CE("Bad opcode",b);b=void 0}k=m.getImageData.apply(m,e);l=k.data;s=e[2]*e[3]*4;for(var d=0;d<s;d+=4)v(b,l,d);m.putImageData(k,e[0],e[1])}}function u(b,e,k,l,s,v){f(b,e,k,l,s,function(d,q,r,K){v=v||z.getImageData(d,q,r,K).data;return function(M,O,N){v[N+3]&&M(O,N,v,N)}})}function g(b){var e=slice(arguments,1);return function(k){var l=0;switch(k){case 0:arguments[1]="black";l=1;break;case 15:arguments[1]="white";l=1;break;
case 10:return;default:arguments[1]=b(arguments[1]);if(arguments[1]===undefined)return;if(k!==12)return e[2].apply(this,arguments)}return e[l].apply(this,slice(arguments,1))}}function j(b,e,k,l,s,v){v=v||m;v.fillStyle=b;v.fillRect(e,k,l,s)}function i(b,e,k,l,s,v){var d=Math.floor(b/(H*B))*B;b=Math.floor((b-H*d)/B);for(var q=0;q<s;q+=B){if(d>H-B)break;for(var r=Math.min(s-q,B),K=l;K>0;){var M=Math.min(H-b,K);v(e+l-K,k+q,b,d,M,r);b+=M;if(b>=H){d+=B;b=0;if(d>H-B)break}K-=M}}}var o=this;c=$(c)[0];var m=
c.getContext("2d"),w=document.createElement("canvas");w.width=c.width;w.height=c.height;var z=w.getContext("2d"),D=document.createElement("canvas");D.width=D.height=8;var t=D.getContext("2d");D=document.createElement("canvas");D.width=D.height=480;var F=D.getContext("2d"),L=function(){var b={cx:0,cy:0};return function(e,k,l,s,v,d,q,r){var K=k.width,M=k.height;q=q<K?q:K;r=r<M?r:M;b.cx=v<K-q?v:K-q;b.cy=d<M-r?d:M-r;0<b.cx&&0<b.cy&&e.drawImage(k,q,r,b.cx,b.cy,l,s,b.cx,b.cy);return b}}();this.show=function(){$(c).show()};
this.hide=function(){$(c).hide()};this.setSize=function(b,e){if(typeof b==="number")c.width=w.width=b;if(typeof e==="number")c.height=w.height=e};this.width=function(){return c.width};this.height=function(){return c.height};var I=[],x=[],y=[],A=[],B=20;this.SetCacheSize=function(b,e,k,l,s,v){I=Array(b);for(s=0;s<b;++s)I[s]=Array(e);x=Array(k);y=Array(k);A=Array(l);if(typeof v==="number")B=v};this.CacheImage=function(b,e,k){var l=I[b];l instanceof Array||(l=I[b]=[]);ImageCache.free(l[e]);l[e]=k};this.getCachedImage=
function(b,e){var k=I[b];return k&&k[e]};this.clearImageCache=function(){I.forEach(function(b){b&&b.forEach(ImageCache.free,ImageCache)});I=[]};this.CacheColorBrush=function(b,e){x[b]=p(e)};this.getCachedColorBrush=function(b){return x[b]};this.CacheBrushBitmap=function(b,e){y[b]=e};this.getCachedBrushBitmap=function(b){return y[b]};this.CacheCursor=function(b,e,k,l){A[b]={image:"data:"+e,dx:k,dy:l};this.SetCursor(b)};this.getCacheCursor=function(b){return A[b]};var E=[function(b,e){b[e]=0;b[e+1]=
0;b[e+2]=0},function(b,e,k,l){b[e]=~(b[e]|k[l])&255;b[e+1]=~(b[e+1]|k[l+1])&255;b[e+2]=~(b[e+2]|k[l+2])&255},function(b,e,k,l){b[e]&=~k[l]&255;b[e+1]&=~k[l+1]&255;b[e+2]&=~k[l+2]&255},function(b,e,k,l){b[e]=~k[l]&255;b[e+1]=~k[l+1]&255;b[e+2]=~k[l+2]&255},function(b,e,k,l){b[e]=~b[e]&255&k[l];b[e+1]=~b[e+1]&255&k[l+1];b[e+2]=~b[e+2]&255&k[l+2]},function(b,e){b[e]=~b[e]&255;b[e+1]=~b[e+1]&255;b[e+2]=~b[e+2]&255},function(b,e,k,l){b[e]^=k[l];b[e+1]^=k[l+1];b[e+2]^=k[l+2]},function(b,e,k,l){b[e]=~(b[e]&
k[l])&255;b[e+1]=~(b[e+1]&k[l+1])&255;b[e+2]=~(b[e+2]&k[l+2])&255},function(b,e,k,l){b[e]&=k[l];b[e+1]&=k[l+1];b[e+2]&=k[l+2]},function(b,e,k,l){b[e]=~(b[e]^k[l])&255;b[e+1]=~(b[e+1]^k[l+1])&255;b[e+2]=~(b[e+2]^k[l+2])&255},function(){},function(b,e,k,l){b[e]|=~k[l]&255;b[e+1]|=~k[l+1]&255;b[e+2]|=~k[l+2]&255},function(b,e,k,l){b[e]=k[l];b[e+1]=k[l+1];b[e+2]=k[l+2]},function(b,e,k,l){b[e]=~b[e]&255|k[l];b[e+1]=~b[e+1]&255|k[l+1];b[e+2]=~b[e+2]&255|k[l+2]},function(b,e,k,l){b[e]|=k[l];b[e+1]|=k[l+
1];b[e+2]|=k[l+2]},function(b,e){b[e]=255;b[e+1]=255;b[e+2]=255}],J=function(){var b,e,k,l;o.ResetClipRect=o.r=function(){b=e=0;k=l=12345;m.restore()};o.SetClipRect=o.s=function(v,d,q,r){b=v;e=d;k=v+q;l=d+r;m.save();m.beginPath();m.moveTo(v,d);m.lineTo(v,l);m.lineTo(k,l);m.lineTo(k,d);m.clip()};m.save();o.ResetClipRect();var s=Array(4);return function(v,d,q,r){s[0]=v<b?b:v>k?k:v;s[2]=(v+q<b?b:v+q>k?k:v+q)-s[0];s[1]=d<e?e:d>l?l:d;s[3]=(d+r<e?e:d+r>l?l:d+r)-s[1];return s}}(),G=g(retArg,L.bind(this,
m),j,function(b,e,k,l,s,v,d,q){e=L(z,e,k,l,s,v,d,q);e.cx>0&&u(b,k,l,e.cx,e.cy)});this.MemBlt=function(b,e,k,l,s,v,d,q,r){G(b,this.getCachedImage(v,d),e,k,l,s,q||0,r||0)};this.ImageBlt=function(b,e,k,l,s){G(12,s,b,e,k,l,0,0);ImageCache.free(s)};this.ScreenBlt=function(b,e,k,l,s,v,d){if(b==12){L(z,c,0,0,l,s,v,d);L(m,w,e,k,l,s,0,0)}else G(b,c,e,k,l,s,v,d)};this.PatBlt=function(b){return function(e,k,l,s,v,d){b(e,d,k,l,s,v)}}(g(h,j,j,function(b,e,k,l,s,v){f(b,k,l,s,v,function(){e=n(e);return function(d,
q,r){d(q,r,e,0)}})}));this.DstBlt=function(b,e,k,l,s){this.PatBlt(b,e,k,l,s,16777215)};this.DrawRect=function(b,e,k,l,s){j(h(s),b,e,k,l)};this.DrawPolyline=function(){function b(l,s,v){l.strokeStyle=s;l.beginPath();s=v[0];l.moveTo(s[0]+0.5,s[1]+0.5);for(var d=1;d<v.length;++d){s=v[d];l.lineTo(s[0]+0.5,s[1]+0.5)}l.stroke()}var e=b.bind(this,m),k=g(h,e,e,function(l,s,v){var d;if(!v||v.length===0)d={size:[0,0]};else{d=v[0];for(var q=[d[0],d[1]],r=[d[0],d[1]],K=1;K<v.length;++K){d=v[K];if(q[0]>d[0])q[0]=
d[0];if(r[0]<d[0])r[0]=d[0];if(q[1]>d[1])q[1]=d[1];if(r[1]<d[1])r[1]=d[1]}d={lt:q,rb:r,size:[r[0]-q[0]+1,r[1]-q[1]+1]}}if(d.size[0]){z.clearRect(d.lt[0],d.lt[1],d.size[0],d.size[1]);b(z,s,v);u(l,d.lt[0],d.lt[1],d.size[0],d.size[1])}});return function(l,s,v){k(l,v,s)}}();this.DrawLine=function(){var b=Array(2);return function(e,k,l,s){b[0]=k;b[1]=l;o.DrawPolyline(e,b,s)}}();this.PatBltWithColorBrush=function(){var b=g(function(e){return e&&(e.tagName==="IMG"?p(e):e)},function(e,k,l,s,v){if("width"in
e?k%e.width===0&&l%e.height===0:k===0&&l===0)j(e,k,l,s,v);else{k=J(k,l,s,v);j(e,0,0,k[2],k[3],z);e=k[0];l=k[1];m.putImageData(z.getImageData(0,0,k[2],k[3]),e,l)}},j,function(e,k,l,s,v,d){j(k,0,0,v,d,z);z.putImageData(z.getImageData(0,0,v,d),l,s);u(e,l,s,v,d)});return function(e,k,l,s,v,d){b(e,d,k,l,s,v)}}();this.PatBltWithCachedColorBrush=function(b,e,k,l,s,v){var d=this.getCachedColorBrush(v);d?this.PatBltWithColorBrush(b,e,k,l,s,d):CE("PatBltWithCachedColorBrush",v)};this.PatBltWithBrushBitmap=
function(b,e,k,l,s,v,d,q){var r=t.createImageData(8,8),K=r.data;q=n(q);d=n(d);for(var M=0,O=7;O>=0;--O)for(var N=v[O],P=0;P<8;++P){var Q=N&1<<P?d:q;K[M++]=Q[0];K[M++]=Q[1];K[M++]=Q[2];K[M++]=255}t.putImageData(r,0,0);v=t.createPattern(t.canvas,"repeat");v.width=v.height=8;this.PatBltWithColorBrush(b,e,k,l,s,v)};this.PatBltWithCachedBrushBitmap=function(b,e,k,l,s,v,d,q){var r=this.getCachedBrushBitmap(v);r?this.PatBltWithBrushBitmap(b,e,k,l,s,r,d,q):CE("PatBltWithCachedBrushBitmap",v)};var C=function(b){try{c.style.setProperty("cursor",
b,"important")}catch(e){CI("Using DIV cursor");var k=0,l=0;C=function(r){r=r.split(" ");s.style.backgroundImage=r[0];k=parseInt(r[1]);l=parseInt(r[2])};var s=document.createElement("div"),v=$(s);s.className="cursor";c.parentNode.appendChild(s);var d=v.width(),q=v.height();$(c.parentNode).css("cursor","none").mousemove(function(r){r={left:r.pageX-k,top:r.pageY-l};v.width(Math.min(c.width-r.left,d)).height(Math.min(c.height-r.top,q)).offset(r)});C(b)}};this.SetCursor=function(b){(b=this.getCacheCursor(b))&&
C("url('"+b.image+"') "+b.dx+" "+b.dy+", auto")};this.SetDefaultCursor=C.bind(this,"auto");this.SetNullCursor=C.bind(this,"url('data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='),auto");var H=$(D).attr("width");this.BitmapSave=function(b,e,k,l,s){i(b,e,k,l,s,function(v,d,q,r,K,M){F.putImageData(m.getImageData(v,d,K,M),q,r)})};this.BitmapRestore=function(b,e,k,l,s){i(b,e,k,l,s,function(v,d,q,r,K,M){m.putImageData(F.getImageData(q,r,K,M),v,d)})};this.DrawEllipse=function(b,
e,k,l,s){m.strokeStyle=h(s);m.beginPath();s=m;if(k==l){l=k/2;s.arc(b+l,e+l,l,0,2*Math.PI,false)}else{var v=k/2*0.5522848,d=l/2*0.5522848,q=b+k,r=e+l;k=b+k/2;l=e+l/2;s.moveTo(b,l);s.bezierCurveTo(b,l-d,k-v,e,k,e);s.bezierCurveTo(k+v,e,q,l-d,q,l);s.bezierCurveTo(q,l+d,k+v,r,k,r);s.bezierCurveTo(k-v,r,b,l+d,b,l)}m.stroke()};a.hookUp("display",this,{definstruction:"MemBlt",isDefault:true});this.DesktopSave=this.BitmapSave;this.DesktopRestore=this.BitmapRestore;$(a).on("close",function(){o.clearImageCache();
o.hide()})};function audioHTML5(a){CI("Old style audio");this.Training=function(){a.fastSend("a","t",slice(arguments))};this.Close=noop;var c=1;this.Volume=function(f,u){c=(f+u)/2};var h=0.1875/22050*1E3,n=false,p=[];this.Play=function(f,u,g,j){function i(){o.play();n=true;setTimeout(function(){var m=p.pop();if(m)m();else n=false;a.fastSend("a","p",[Date.now()+f&65535,u]);revoke(o)},Math.round(j?j/10:(g.length-144)*h))}f-=Date.now();var o=new Audio(blobURL(g,"audio"));o.volume=c;n?p.unshift(i):i()}}
audioHTML5.Context=window.Audio;
function audioWebAPI(a){CI("Web Audio API");var c,h;this.Training=function(){a.fastSend("a","t",slice(arguments));if(!c)try{c=new audioWebAPI.Context;h=c.destination;CI("Audio open")}catch(j){CE("Failed to open audio")}};this.Close=noop;var n,p;this.Volume=function(j,i){j=(j&65535)/65536;i=(i&65535)/65536;CI("Audio volume",j,i);if(!n){n=c.createGainNode();if("createChannelMerger"in c){CI("Stereo gain control");var o=c.createChannelMerger();o.connect(h);n.connect(o,0,0);p=c.createGainNode();p.connect(o,
0,1);h=c.createChannelSplitter();h.connect(n,0,0);h.connect(p,1,0)}else{n.connect(h);h=n}}if(p){n.gain.value=j;p.gain.value=i}else n.gain.value=(j+i)/2};var f=-1,u=0;this.Play=function(j,i,o,m){j-=Date.now();c.decodeAudioData(decode(o),function(w){var z=c.createBufferSource();z.connect(h);z.buffer=w;var D=c.currentTime;if(f<D)f=D;if(f<u)f=u;z.noteOn(f);u=f+(m?m/1E4:w.duration);g(function(t){a.fastSend("a","p",[t+j&65535,i],true)},Math.floor((u-D)*1E3))},function(w){a.fastSend("a","p",[0,i]);CE(w||
"Audio error")})};var g=function(j){$(a).on("send",function(){j=j.filter(function(i){return i(this)},Date.now())});return function(i,o){var m=Date.now()+o,w=setTimeout(function(){w=null;i(Date.now())},o+20);j.push(function(z){if(w===null)return false;if(m-z<20){clearTimeout(w);i(z);return false}return true})}}([])}audioWebAPI.Context=window.AudioContext||window.webkitAudioContext;var audio=audioWebAPI.Context?audioWebAPI:audioHTML5;function Input(a,c,h){var n,p=$("#virt_keyboard"),f=$(c).find("#canvas")[0];globals.useScancodes&&CI("Old style scancodes");var u=function(j,i,o){return function(){o!==undefined&&clearTimeout(o);if(i>0)o=setTimeout(j,i)}}(a.close.bind(a,"Session has timed out"),globals.sessionTimeoutMinutes*6E4);u();var g=false;this.start=function(){function j(d,q){B[2]=J(d.which);B[3]=q;return E(d,B)}function i(d){function q(N){N instanceof Array&&a.fastSend("u","m",N)}function r(N){function P(){r()}switch(N){case null:case false:case true:K!==
undefined&&clearTimeout(K);if(!N)break;case undefined:if(d){a.fastSend("u","m",d);M=Date.now();d=undefined}K=undefined;break;default:d=N;N=Date.now()-M;if(N>=O)r(true);else if(K===undefined)K=setTimeout(P,O-N)}}if(globals.minSendInterval===0)return q;var K,M=Date.now(),O=globals.minSendInterval||100;return r}function o(d,q){for(var r=0;r<d.length;++r)if(d[r].identifier===q.identifier)return d[r]}function m(d,q,r){d.which=q;r=r||-1;r&1&&a.fastSend("u","b",j(d,1));r&2&&a.fastSend("u","b",j(d,0))}function w(d){e=
false;u();var q=d.which;logToFile("keydown",q,d.originalEvent.keyIdentifier);t(d);q===globals.clipboardKey&&d.altKey&&h&&h.open();if(q===93){a.fastSend("u","s",[0,221,0]);a.fastSend("u","s",[32768,221,0]);return false}if(globals.useScancodes)if(95<q&&q<106)d.which=q-48;else{if(q===110)d.which=190}else if(!(d.altKey^d.ctrlKey)&&q!==46){var r=d.originalEvent.keyIdentifier;if(r){if((33<=q&&q!==144||q===0)&&r.substring(0,2)==="U+")return e=true}else if(42<=q&&q<=111)return e=true}A[1]=q=F(d,true);if(b[q])A[0]=
16384;else{b[q]=true;A[0]=0}A[2]=d.originalEvent.keyLocation||0;a.fastSend("u","s",A);return false}function z(d){var q=F(d,false);if(b[q]){b[q]=false;A[1]=q;A[0]=49152;A[2]=d.originalEvent.keyLocation||0;a.fastSend("u","s",A);return false}}function D(d,q){return copyObject(q,{which:d})}function t(d){if(d.altKey!==!!b[18]&&d.which!==18)(d.altKey?w:b[17]?z:L)(D(18,d));if(d.ctrlKey!==!!b[17]&&d.which!==17)(d.ctrlKey?w:z)(D(17,d));if(d.shiftKey!==!!b[16]&&d.which!==16)(d.shiftKey?w:z)(D(16,d))}function F(d,
q){var r=d.which;if(r!==18&&d.altKey&&globals.specialKeys)switch(r){case 35:if(d.ctrlKey)return 46;break;case 33:return 9;case 34:d.shiftKey||(q?w:z)(D(16,d));return 9;case 36:if(d.ctrlKey)break;if(!q){z(D(27,d));return 17}d.altKey=false;L(D(18,d));d.ctrlKey=true;w(D(17,d));case 0:case 45:case 48:case 96:return d.ctrlKey?45:27}if(k){if(r===16){if(!q)return b[20]?20:16;if(b[16]){z(d);return 20}}if((d.altKey||d.ctrlKey)&&r===192)return 9;if(d.ctrlKey){if(d.altKey&&(r===37||r===39)){d.altKey=false;L(D(18,
d));return r==37?36:35}if(49<=r&&r<=57)r+=63;else if(r===189)r=122;else if(r===187)r=123;else return r;(q?z:w)(D(17,d))}}return r}function L(d){z(d);w(d);z(d)}function I(d){setTimeout(function(){var q=innerWidth/v;if(window.orientation===90||window.orientation===-90)q*=0.7;q=Math.round(q);var r=globals.rightToLeft?q:innerWidth-q*2;p.width(q).height(Math.round(q*0.8)).offset({left:pageXOffset+r,top:pageYOffset})},d||0)}if(!g){g=true;var x=[0],y=[0,0],A=[0,0,0],B=[0,0,0,0],E=function(d){return function(q,
r){r[0]=q.pageX;r[1]=q.pageY;r.changed=r[0]!==d[0]||r[1]!==d[1];if(r.changed){d[0]=r[0];d[1]=r[1]}return r}}([-1,-1]),J=function(d){return function(q){return q<d.length?d[q]:0}}([0,4096,16384,8192]),G=function(d){return function(q){for(var r=q[0],K=1;K<q.length;++K)if(d(q[K].pageX,r.pageX))r=q[K];return r}}(globals.leftHanded?function(d,q){return d>q}:function(d,q){return d<q}),C,H;if(a.isHTTPS){H=i();$(a).on("send.input",H.bind(window,true))}$(c).on("contextmenu",false).on(is.mobile?{"touchstart.input":function(d){var q=
C,r=Date.now();d=d.originalEvent.touches;C=G(d);C.start=r;C.origX=C.pageX;C.origY=C.pageY;C.count=d.length;if(q&&q.identifier!==C.identifier&&r-q.start<500)C.prev=q},"touchmove.input":function(d){if(C)if(!H){if(C.count>2)return false;if(C.count===1&&(Date.now()-C.start>500||is.apple&&!is.vko&&f.width<=innerWidth&&f.height<=innerHeight)){m(C,1,1);H=i();return false}C=undefined}if(H){(d=o(d.originalEvent.changedTouches,C))&&H(E(d,y));return false}},"touchend.input":function(d){if(C){var q=o(d.originalEvent.changedTouches,
C);if(q){if(H){m(q,1,2);H=H(false)}else if(C.count>2){d=q.pageX-C.origX;var r=Math.abs(d);q=q.pageY-C.origY;var K=Math.abs(q);if(r<10&&K<10){a.fastSend("u","s",[0,18,0]);a.fastSend("u","s",[0,37,0]);a.fastSend("u","s",[32768,37,0]);a.fastSend("u","s",[32768,18,0])}else{d=r>K?d<0?39:37:q<0?34:33;a.fastSend("u","s",[0,d,0]);a.fastSend("u","s",[32768,d,0])}}else{d=Date.now()-C.start<500?1:3;r=C.prev||C;m(r,d);if(C.count===1)return false;m(r,d)}C=undefined;return false}}}}:{"mousedown.input":function(d){t(d);
a.fastSend("u","b",j(d,1));if(d.which===1&&!H)H=i()},"mouseup.input":function(d){a.fastSend("u","b",j(d,0));if(d.which===1&&H&&!a.isHTTPS)H=H(false);u();return false},"mousemove.input":function(d){if(E(d,y).changed)H?H(y):a.fastSend("u","m",y);return false},"mousewheel.input":function(d,q){A[2]=q*120;A[2]!==0&&a.fastSend("u","w",E(d,A));u();return false}}).focus();var b=[],e;$(document).on({"keydown.input":w,"keyup.input":z,"keypress.input":function(d){if(e){x[0]=NaN;if(d.which>=33)x[0]=d.which;else if(d.which===
0&&d.originalEvent.keyIdentifier)x[0]=parseInt(d.originalEvent.keyIdentifier.substring(2),16);isNaN(x[0])||a.fastSend("u","u",x)}return false}});var k=globals.chromeKeys&&is.chromeOS;if(is.mobile){window.scroll=function(d){return function(){I();return d.apply(this,arguments)}}(scroll);var l=0,s;p.show().on("click.input",function(){s=[pageXOffset,pageYOffset];(Date.now()-l>500?n:c).focus()});n=p.find("input").on({"focus.input":setImmediate.bind(window,function(){is.vko=true;if(s){is.apple&&scroll.apply(window,
s);s=undefined}I()}),"blur.input":function(){is.vko=false;l=Date.now();I()}});$(window).on({"resize.input":I,"scroll.input":I,"orientationchange.input":I});I();I(1E3)}var v=10/(window.devicePixelRatio||1.5)}};this.stop=function(){if(g){g=false;$(a).off(".input");$(document).off(".input");$(c).off(".input");$(window).off(".input");p&&p.off(".input");n&&n.off(".input")}};$(a).on("close.input",this.stop.bind(this))};ZeroClipboard.setMoviePath("resources/ZeroClipboard.swf");var DEFTYPE="text/plain";
function clipboard(a){function c(f){var u={};this.registerType=function(i,o){if(o)u[i]=o;else delete u[i]};this.registerType(DEFTYPE,function(i){return","+encodeURIComponent(i.replace(/($|[^\r])\n/g,"$1\r\n"))});var g,j;this.set=function(i,o){g=i;j=o||[DEFTYPE]};this.getTypes=function(){return j};this.getData=function(i){function o(m,w){var z=u[w];return z?"data:"+w+z(m):""}i=i||DEFTYPE;return j.indexOf(i)!==-1?o(g,i):""};this.clear=function(){g=j=undefined};this.notify=function(){arguments.length&&
this.set.apply(this,arguments);j.length&&f.send("C","f",[j.join(",")])};this.send=function(i){(i=this.getData(i))&&f.send("C","d",[i])};this.request=function(i){i=i||DEFTYPE;f.send("C","r",[i])};this.FormatList=function(){$(this).triggerHandler("types",slice(arguments))};this.Data=function(i){i.indexOf("data:"+DEFTYPE)===0&&$(this).triggerHandler("data",i)};this.FormatRequest=this.send;f.hookUp("clipboard",this,{definstruction:"FormatList",shortName:"B"})}function h(f){$(f).on({types:c.requestText,
data:function(g,j){clipboardData.setData("Text",c.extractText(j))}});var u;$(window).focus(function(){var g=clipboardData.getData("Text");if(g!==u){u=g;f.notify(g)}})}function n(f,u,g){function j(){i();m&&m.hide();f.removeClass("clipboard_button_active").addClass("clipboard_button")}var i=function(z){return function(D){z!==undefined&&clearTimeout(z);z=D>0&&setTimeout(j,D*1E3)}}();f=$(f);var o=f.children("#clipboard_image");f.children("img").click(j);u=$(u);if(globals.clipboardUseFlash&&supportsMIME("swf")){var m=
new ZeroClipboard.Client;m.setText("");m.setHandCursor(true);m.setCSSEffects(true);m.addEventListener("load",function(){CI("Clipboard Flash movie loaded")});m.addEventListener("complete",function(){CI("Copied to clipboard",m.clipText);j()});m.addEventListener("mouseover",i.bind(this,undefined));m.addEventListener("mouseout",i.bind(this,globals.clipboardTimeoutSeconds))}else{var w=dialog.modal(u,{options:{resizable:true,width:"auto",buttons:{Close:function(){$(this).dialog("close")}},open:function(){$(this).find("textarea").enable()}}});
o.off("click").click(function(){j();w.open()})}$(g).on({types:c.requestText,data:function(z,D){D=c.extractText(D);$("textarea").val(D);f.removeClass("clipboard_button").addClass("clipboard_button_active").if_(globals.rightToLeft).css({left:"40px",right:"auto"});i(globals.clipboardTimeoutSeconds);m&&setTimeout(function(){m.setText(D);m.div?m.show():m.glue(o[0],f[0])},500)}})}function p(f,u,g){f=$(f);var j=f.find("textarea"),i=dialog.modal(f,{options:{resizable:true,width:"auto",buttons:{Copy:function(){var w=
j.val();w&&g.notify(w);f.dialog("close")},Close:f.dialog.bind(f,"close")},open:j.enable.bind(j)}});if(u){u=$(u);u.off("click").click(i.open).css("display","inline-block");if(globals.rightToLeft){var o=u.css("left"),m=u.css("right");u.css({left:m,right:o})}}return i}c.requestText=function(){slice(arguments,1).indexOf(DEFTYPE)!==-1&&this.request()};c.extractText=function(f){return decodeURIComponent(f.substring(f.indexOf(",")+1))};a=new c(a);if(window.clipboardData)h(a);else{n("#clipboard_button","#clipboard_container",
a);return p("#clipboard_dialog","#clipboard_menu",a)}};function transfer(a){function c(g){g=n(g);var j=$("<iframe>").addClass("hidden").appendTo($(document.body));setTimeout(function(){CI("Download",g);j[0].contentWindow.location.replace(g)},0)}function h(g){function j(m){if(m!=="#"){m=n(m);for(var w=dialog.progressbar({html:"Uploading "+(g.length===1?g[0].name||g[0].fileName:"files"),onCancel:function(){F.abort()}}),z=new FormData,D=0;D<g.length;++D){var t=g[D].name||g[D].fileName;CI("Upload",t,m);z.append(t,g[D])}var F=new XMLHttpRequest;F.open("POST",
m,true);m=F.upload||F;if("onprogress"in m)m.onprogress=function(L){w(L.lengthComputable?L.loaded/L.total*100:-1)};else w(-1);m.onload=function(){w()};m.onerror=function(){w();CE("Upload failed"+(F.statusText?": "+F.statusText:""))};F.send(z)}}if(globals.fileUpload)if("FormData"in window){if(g&&g.length){for(var i=0,o=0;o<g.length;++o){if(!g[o].type&&(g[o].name||g[o].fileName).indexOf(".")===-1){dialog.notify("AccessNow does not support uploading folders");return}i+=g[o].size||g[o].fileSize||0}i>>=
20;o=f.push(j);g.length===1?a.send("c","u",[o,i,g[0].name||g[0].fileName]):a.send("c","U",[o,i])}}else dialog.notify("This browser does not support AccessNow file upload",true);else dialog.notify("Uploading files to remote session is disabled")}var n=function(){var g=a.options(),j=!g.gateway?"":"?address="+encodeURIComponent(g.address)+"&port="+g.port+"&secured="+(g.encryption?"true":"false"),i=a.address();if(i==location.host)return function(m){return m.substring(1)+j};var o=(g.gateway||g.encryption?
"https":"http")+"://"+i;return function(m){return o+m+j}}(),p=function(){if(!globals.printing)return function(){dialog.notify("Printing from remote session is disabled")};var g=[],j=dialog.modal('<div title="Print Output Ready">Click the View button to display the print output as a PDF.<br />You can then send it to a local printer, save it or email it.</div>',{onClose:function(){g=[]},options:{width:"auto",buttons:{View:function(){for(var i=0;i<g.length;++i){CI("Print",g[i]);window.open(g[i])}$(this).dialog("close")},
Cancel:function(){$(this).dialog("close")}}}});return function(i){g.push(n(i));j.open()}}(),f=[];$(document.body).on({"dragenter.upload":cancelEvent,"dragover.upload":cancelEvent,"drop.upload":function(g){cancelEvent(g);h(g.originalEvent.dataTransfer.files)}});$(a).on("close",function(){$(document.body).off(".upload")});globals.fileDownload&&$("#download_menu").css("display","inline-block").click(a.fastSend.bind(a,"c","d"));globals.fileUpload&&function(g){function j(i){var o=$('<input type="file" multiple="multiple" id="upload" />');
if(i){h(i.originalEvent.target.files);g.replaceWith(o)}else $("#upload_menu").append(o);g=o.on("change",j)}$("#upload_menu").css("display","inline-block");j()}();var u=function(){var g,j=[];return function(i){j.push(i);g||(g=dialog.notify({html:"Open Link",onClose:function(){j=[];g=null},options:{buttons:{"On Client":function(){for(var o=0;o<j.length;++o)window.open(j[o]);$(this).dialog("close")},"On Server":function(){for(var o=0;o<j.length;++o)a.send("c","o",j);$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}}}))}}();
return function(g,j,i){i=i||0;switch(g){case 0:p(j);break;case 1:c(j,i);break;case 2:g=i;if(i=f[--g]){delete f[g];i(j)}break;case 3:u(j)}}};function session(a){function c(){if(z)z=z.close()}function h(t){if(isString(t)){if(t.substring(0,6)==="Error:"){c();i.close(t);return}logToFile("Connection data:",t);t=new Data(t)}t.set("protocol out of band data",1);if(globals.isManaged){globals.id&&t.set("wc client",1);u.encryption=isTrue(t.get("websocket encrypt"))||isTrue(t.get("AN_UseSSL"));u.port=t.get("websocket port")||u.port;u.address=t.get("websocket address");t.remove("websocket address");if(u.address)u.target=t.get("full address");else{u.address=
t.get("full address").split(":")[0];t.set("full address","localhost")}if(isTrue(t.get("use ericom secure gateway"))||isTrue(t.get("use ericom security server"))){t.set("use ericom secure gateway",0);t.set("use ericom security server",0);u.gateway=t.get("secure gateway hostname")||t.get("security server hostname")}else delete u.gateway;u.username=t.get("username");u.password=t.get("html password")||t.get("wc password");t.set("html password",u.password);if(t.get("screen mode id")!==1||!t.get("desktopwidth")||
!t.get("desktopheight")){t.set("screen mode id",1);t.set("desktopwidth",p.desktopwidth);t.set("desktopheight",p.desktopheight)}var F=t.get("alternate shell");if(F&&globals.parameters){var L=decodeURIComponent(globals.parameters);t.set("alternate shell",F+" "+L);(F=t.get("RDP_WCConnectionName"))&&t.set("RDP_WCConnectionName",F+"["+encodeURIComponent(L)+"]")}F=t.get("RDP_WCConnectionName");isString(F)&&t.set("RDP_WCConnectionName",F.toLowerCase());u.clientID=t.get("authentication ticket client id");
u.serverID=t.get("authentication ticket server id");i.start(u)}else{if(parseInt(p["blaze image quality"])<40&&t.get("session bpp")>16)p["session bpp"]=16;t.each(p);t.set("full address",t.get("full address")||"localhost");globals.console&&t.set("connect to console",1);t.remove("wc client")}globals.clipboard===false&&t.set("redirectclipboard",0);globals.printing===false&&t.set("redirectprinters",0);globals.fileDownload===false&&globals.fileUpload===false&&t.set("drivestoredirect","");i.send("c","c",
[t.toString()]);n=t.get("full address");globals.clipboard=globals.clipboard&&isTrue(t.get("redirectclipboard"));w.setSize(t.get("desktopwidth"),t.get("desktopheight"))}var n,p=copyObject(a.configuration);if(p.username&&!usernameContainsDomain(p.username)&&p.domain)p.username=p.domain+"\\"+p.username;var f=isString(a.address)?a.address.split(":"):[location.hostname],u={address:f[0],port:a.port||f[1],encryption:!!a.encryption,gateway:a.gateway,username:p.username,password:p["html password"]},g=globals.name||
a.name||p["full address"]||f.join(":"),j=a.restart||dialog.restart({html:"Session canceled",restart:function(){o.leaveFullScreen();if(globals.endURL)switch(globals.endURL.charAt(0)){case "#":var t=top.open("","_self","");t.focus();t.opener=top;t.close();break;case "^":location=globals.endURL.substring(1);break;default:top.location=globals.endURL}else if(globals.autostart)location.replace(location.href.replace(/(\?.*)?$/,"?autostart=false"));else return true}}),i=new Protocol,o=$("#canvas");o.preventSelection();
var m,w=new Raster(i,o);f=function(){function t(x){x=isString(x)?x:x&&$.isFunction(x.reason)?x.reason():"Connection failed";if(globals.showAddress){x+="<br /><br />(";x+=i.isGateway()?"Gateway address is '"+i.address()+"'<br />Server address is '"+u.address:"Server address is '"+i.address();if(n)x+="'<br />RDP host address is '"+n;x+="')"}return x}var F=false,L=false,I=false;$(i).on({connect:function(){L=true},open:function(x,y,A){I=true;$(window).on("beforeunload",function(){if(globals.leaveMessage)return globals.leaveMessage});
if(a.GUID){x=p.username||"";CI("Licensing: "+a.GUID+" "+x);this.send("c","l",[clientType(),a.GUID,x])}if(globals.clipboard&&!is.mobile)var B=clipboard(this);m=new Input(this,o.parent(),B);this.hookUp("audio",new audio(this),"Play");if(is.mobile||A<2)globals.fileUpload=globals.fileDownload=false;D=transfer(this)},error:function(x,y){if(!F){$(window).off("beforeunload");c();j(t(y),true);this.close()}},close:function(x,y){if(!(!F&&this.isError())){$(window).off("beforeunload");c();var A=false;if(!F){var B=
this.isGateway();if(y)A=true;else if(I)y=B?"Gateway session disconnected.":"Session disconnected.";else{A=true;y=L?"Failed to open connection to AccessNow server"+(B?" using Gateway.":"."):B?"Connection failed - verify that the Ericom Secure Gateway is running and reachable.":u.encryption?"Connection failed - some browsers do not support encrypted connections for desktop sessions. Please try to connect with SSL encryption disabled.":"Connection failed - verify that the Ericom AccessNow server is running and reachable."}if(A)y=
t(y)}B=j(y,A);!A&&globals.noEndDialog&&B()}}});return function(){F=true;i.close("Connection canceled")}}();var z=dialog.progress({html:"Establishing connection to "+g,canceling:"Canceling ...",onCancel:f}),D;f={State:function(t){if(typeof t==="string"){var F=t.toLowerCase();if(F==="connected"||F==="logged in"){setTimeout(c,2500);w.show();m.start();scroll(0,w.height()-innerHeight)}else z&&z.title(t+" to "+g)}},DesktopSize:w.setSize.bind(w),Title:function(t){document.title=(i.isHTTPS?"-":"")+t.replace(/localhost(:\d+)?/i,
g)},Message:function(t,F){c();t=t.replace(/localhost(:\d+)?/i,u.address+"$1");F?i.close(t):dialog.notify(t)},Open:function(){$.isFunction(D)&&D.apply(this,arguments)},Ping:function(t){i.send("c","p",[t])},PacketSize:function(){i.fastSend("c","s",slice(arguments))}};i.hookUp("control",f,"PacketSize");if(!globals.isManaged){u.target=p["full address"];i.start(u)}a.data?h(a.data):$.ajax({url:globals.id?"../GetConnectionInfo.asp?ConnectionName="+encodeURIComponent(globals.id):globals.settingsURL||"resources/blaze.txt",
cache:false,success:h,error:function(t,F,L){CE("Query failed",F,L);if(F!=="abort")globals.isManaged?j("Failed to download settings from server"):h()}})}
function Data(a){a=a.split("\n").reduce(function(c,h){var n=h.match(/([^:]+):(.):(.*)/);if(n)c[n[1].trim()]=n[2]==="i"?parseInt(n[3]):n[3];return c},{});this.has=function(c){return c in a};this.get=function(c){return a[c]||""};this.set=function(c,h){switch(typeof a[c]){case "string":a[c]=h.toString();break;case "number":a[c]=parseInt(h);break;default:a[c]=h}};this.remove=function(c){delete a[c]};this.each=function(c){$.each(c,this.set.bind(this))};this.toString=function(){var c="";$.each(a,function(h,
n){c+=h+":"+(typeof n==="number"?"i":"s")+":"+n+"\n"});return c}};
